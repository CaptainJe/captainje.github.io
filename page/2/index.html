<!doctype html>
<html class="theme-next use-motion theme-next-mist">
<head>
  

<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />








  <link rel="stylesheet" type="text/css" href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5"/>




<link rel="stylesheet" type="text/css" href="/css/main.css?v=0.4.5.1"/>


    <meta name="description" content="Brave Shine" />



  <meta name="keywords" content="CaptainJe" />





  <link rel="shorticon icon" type="image/x-icon" href="https://avatars2.githubusercontent.com/u/13464469?v=3&s=460?v=0.4.5.1" />


<meta name="description" content="Brave Shine">
<meta property="og:type" content="website">
<meta property="og:title" content="CaptainJe's Blog">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="CaptainJe's Blog">
<meta property="og:description" content="Brave Shine">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CaptainJe's Blog">
<meta name="twitter:description" content="Brave Shine">


<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: 'Mist',
    sidebar: 'always'
  };
</script>

  <title> CaptainJe's Blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->
  

  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?4c23a7bd61e4639a1d732369a9c18096";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>



  <div class="container one-column 
   page-home 
">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><h1 class="site-meta">
  <span class="logo-line-before"><i></i></span>
  <a href="/" class="brand" rel="start">
      <span class="logo">
        <i class="icon-next-logo"></i>
      </span>
      <span class="site-title">CaptainJe's Blog</span>
  </a>
  <span class="logo-line-after"><i></i></span>
</h1>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            <i class="menu-item-icon icon-next-home"></i> <br />
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            <i class="menu-item-icon icon-next-categories"></i> <br />
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            <i class="menu-item-icon icon-next-archives"></i> <br />
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            <i class="menu-item-icon icon-next-tags"></i> <br />
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            <i class="menu-item-icon icon-next-about"></i> <br />
            关于
          </a>
        </li>
      

      
      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content"> 
  <section id="posts" class="posts-expand">
    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/09/02/Hello Intel/" itemprop="url">
                Hello Intel
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-09-02T12:13:32+08:00" content="2015-09-02">
            2015-09-02
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/记录/" itemprop="url" rel="index">
                  <span itemprop="name">记录</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/2015/09/02/Hello Intel/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2015/09/02/Hello Intel/" itemprop="commentsCount"></span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
            Hello IntelAbout mehttp://captainje.github.io/about/
Projects overview1.GasSensor
背景介绍，工作经历介绍；
我的贡献，我的收获；
校准算法；

2.LightTrack
背景介绍，基本原理方案介绍；
sensor选型和电路，firmware简单描述；
工作经历展示，气柜；

3.IdeaOptics_LightSource
背景介绍，基本电路介绍
遇到的问题，MOS管选型与调试
cypress的PSOC 和 USB firmware介绍

4.IdeaOptics_ARM
背景介绍，我的贡献
硬件和firmware展示

5.Crem_Luna
背景介绍，系统结构
see Important projects

6.Crem_ESB
背景介绍，机器展示
工作内容介绍

7.Highcore_BlueShield
背景介绍，系统结构
see Important projects

Important projects want to share and discuss1. Luna
bsp分模块说明，重要U
            ...
          </span>
          <div class="post-more-link text-center">
            <a class="btn" href="/2015/09/02/Hello Intel/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/03/04/MCU FreeRTOS下的串口编程/" itemprop="url">
                MCU FreeRTOS下的串口编程
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-03-04T10:12:06+08:00" content="2015-03-04">
            2015-03-04
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/MCU/" itemprop="url" rel="index">
                  <span itemprop="name">MCU</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/2015/03/04/MCU FreeRTOS下的串口编程/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2015/03/04/MCU FreeRTOS下的串口编程/" itemprop="commentsCount"></span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
            描述刚接触FreeRTOS的时候，就对串口在FreeRTOS下如何应用的问题比较困惑，现在完成了一个小项目，也有点心得，在这里记录一下使用方式，方便日后参考：
代码串口中断：1234567891011121314151617181920212223242526272829303132333435363738void USART1_IRQHandler(void)    //User debug&#123;  portBASE_TYPE usart1_Que_Woken=pdFALSE;	if(USART_GetITStatus(USART1,USART_IT_TXE)!=RESET)	&#123;		//USART_ClearITPendingBit(USART1,USART_IT_TXE);		if( xQueueReceiveFromISR( L0_TxQue, &amp;DTS, &amp;usart1_Que_Woken ) == pdTRUE )		&#123;			/* A character was retrieved from the queue so can be s
            ...
          </span>
          <div class="post-more-link text-center">
            <a class="btn" href="/2015/03/04/MCU FreeRTOS下的串口编程/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2014/10/23/记录 明年要有自己的小工作室/" itemprop="url">
                记录 明年要有自己的小工作室
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2014-10-23T08:53:53+08:00" content="2014-10-23">
            2014-10-23
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/记录/" itemprop="url" rel="index">
                  <span itemprop="name">记录</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/2014/10/23/记录 明年要有自己的小工作室/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2014/10/23/记录 明年要有自己的小工作室/" itemprop="commentsCount"></span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
            到现在工作了一年多，硬件上基本的模拟电路，数字电路懂，也画过4层的PCB。软件上，常见MCU的固件基本都能写，正在研究stm32f4系列配合一些嵌入式系统，GUI，等高级一点的应用。
今年GCT过了以后，就开始考虑接外包，搬家以后自己制备点东西，成立自己的小工作室，一方面在公司把固件这块都做熟了，研究好GUI,UCOS，等，再搞搞USB,无线。另一方面跟公司做上位机软件的小伙伴把C++也做到可以写一般软件的地步，再入门LINUX。
下班后，就忙在自己的工作室里，寻找外包项目做。想想都觉得只要GCT过了，生活就会很美好的样子。
（现在搬家博客中，距离这篇日志已经1年多了，我的确通过利用下班时间努力看书，成功进入复旦大学计算机系读工程硕士，也按照计划，接了一个蓝牙盾的外包，虽然经历了那么多难题，跟合作方相处很愉快，项目也到了尾声，收获了很多。 
然而，我并没有觉得生活像当初写这篇日志想象的那样美好。我给自己的目标变了，我看到自己没钱买房子，看到父母舍不得买贵一点的衣服，我总是想要得到更好的东西，有更大的成就；
我真的不知道这样是好是坏，好的方面来讲，正是因为不满足现状会让我更加努力，更有动
            ...
          </span>
          <div class="post-more-link text-center">
            <a class="btn" href="/2014/10/23/记录 明年要有自己的小工作室/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2014/10/08/MCU STM32F429+SDRAM+STEMWIN/" itemprop="url">
                MCU STM32F429+SDRAM+STEMWIN
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2014-10-08T11:08:05+08:00" content="2014-10-08">
            2014-10-08
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/MCU/" itemprop="url" rel="index">
                  <span itemprop="name">MCU</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/2014/10/08/MCU STM32F429+SDRAM+STEMWIN/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2014/10/08/MCU STM32F429+SDRAM+STEMWIN/" itemprop="commentsCount"></span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
            要用STM32F429+SDRAM的方式驱动一块7寸工业LCD屏，移植UCGUI图形界面库来做界面开发
按照官方说明，做了所有的移植步骤，但是屏幕仍旧什么也不显示，所有操作无用，后来看了这篇帖子，帮助很大；
http://bbs.armfly.com/read.php?tid=4550&amp;ds=1&amp;page=e#a
我的主要问题在于：

 关于层的问题。因为默认是1层的。如果要改为2层的。特别注意要先选定层1。要不然什么都不显示。 GUI_SelectLayer(1); 根据DATASHEET.层2是在最上面的。它的尺寸如果和屏幕一样的。  那层1和背景都会被它覆盖。这里说的是LTDC的层。  所以要选择层2绘制。（GUI里面 0- 层1 ，1- 层2）。

没有选择第二层，那么所有操作都在默认的第1层，第二层覆盖在他上面，那么所有的操作都不会有用啊。

            
          </span>
          <div class="post-more-link text-center">
            <a class="btn" href="/2014/10/08/MCU STM32F429+SDRAM+STEMWIN/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2014/09/23/硬件 Microusb接口与OTG/" itemprop="url">
                硬件 Microusb接口与OTG
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2014-09-23T16:20:11+08:00" content="2014-09-23">
            2014-09-23
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/硬件/" itemprop="url" rel="index">
                  <span itemprop="name">硬件</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/2014/09/23/硬件 Microusb接口与OTG/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2014/09/23/硬件 Microusb接口与OTG/" itemprop="commentsCount"></span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
            首先，

Micro AB，ID线悬空，有公母，仅OTG设备使用      
Micro A ID线接地只有公      
Micro B ID线悬空 有公母

比如我的中兴U950手机支持OTG功能

我的手机电脑连接线，确实是 Micro B公转标准A公 ，id线不连GND   这样手机线插在电脑上，手机检测ID还是悬空的，手机就知道自己是Device
我手上的OTG线，其实是MicroA公转标准A母，id线连接GND   这样手机连接U盘后，检测到ID位低，就开始OTG的HNP对话确定自己是主机

但是线上面的标注不一定是指型号，比如我这个MicroA的转接线接头上有一个B字。现在淘宝上的东西应该是没有明确区分Micro A,B所以搜不出来。 
项目上要用到OTG功能，使我的设备可以读取U盘文件，同时也可以插在PC上当做一个外设来使用那么就跟手机一样，插电脑的线用普通的手机电脑连接线 MicroB 公转标准A公插U盘的线用手机OTG线，也就是MicroA 公转标准A母
一开始搜MicroA的插头，转接线等等，淘宝，百度都搜不到，资料上也说的不清不楚，到底ID线和主从机的关系如何确
            ...
          </span>
          <div class="post-more-link text-center">
            <a class="btn" href="/2014/09/23/硬件 Microusb接口与OTG/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2014/09/02/C++ VS2010+WDK 做好USB view的环境搭建/" itemprop="url">
                C++ VS2010+WDK 做好USB view的环境搭建
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2014-09-02T12:06:53+08:00" content="2014-09-02">
            2014-09-02
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/C/" itemprop="url" rel="index">
                  <span itemprop="name">C++</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/2014/09/02/C++ VS2010+WDK 做好USB view的环境搭建/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2014/09/02/C++ VS2010+WDK 做好USB view的环境搭建/" itemprop="commentsCount"></span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
            描述公司要做USB KEY相关的东西，上位机软件需要读取U盘的 VID,PID,Serial number。之前在网上下载了一个VC++6.0做的 控制台程序源码，测试可行，自己改动之后，做出了一个小程序，问题是，这个程序在某些电脑上无法正常读出U盘信息,在某些电脑上却可以。可能是VC++6.0 对WIN7 的兼容性不太好。于是决定转战VS2010+WDK，做一些简单的USB驱动的东西。MSDN的USB VIEW源码是很不错的参考资料。
##　环境搭建

首先VS2010安装，WDK安装，按照步骤进行，之后打开USB view工程（CSDN上下载来的VS2010版本），编译之后，一步一步出现了很多问题，下面逐个解决：


error RC2247 : SYMBOL name too long：

你好，我在2010里面也遇到了error RC2247 : SYMBOL name too long ，我是这么解决的把#define APSTUDIO_HIDDEN_SYMBOLS，，复制到C:/Program Files/Microsoft SDKs/Windows/v7.0A/Inclu
            ...
          </span>
          <div class="post-more-link text-center">
            <a class="btn" href="/2014/09/02/C++ VS2010+WDK 做好USB view的环境搭建/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2014/07/18/MCU STM32f207 ADC+DMA多通道采集，ADC数据大于4096/" itemprop="url">
                MCU STM32f207 ADC+DMA多通道采集，ADC数据大于4096
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2014-07-18T15:33:42+08:00" content="2014-07-18">
            2014-07-18
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/MCU/" itemprop="url" rel="index">
                  <span itemprop="name">MCU</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/2014/07/18/MCU STM32f207 ADC+DMA多通道采集，ADC数据大于4096/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2014/07/18/MCU STM32f207 ADC+DMA多通道采集，ADC数据大于4096/" itemprop="commentsCount"></span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
            这周做stm32f207的ADC时，发现ADC采集到的原始数据可以超过4096，有的已经65000了。stm32的ADC只有12位，最大4095，怎么可能超过4096呢。肯定是数据错位的问题了，我在ADC的初始化程序中，设定其数据对齐模式为右对齐，应该没问题的啊，百思得得其解，开始仿真，发现，ADC_InitStructure中的某些数完全是错误的，我仿真观察变量ADC_InitStructure.ExternalTrigconv ,一建立结构体，这个成员的值就变成了0x08007A47，最后赋值给CR2的时候，第11位也就是数据对其位 就是1 了，左对齐。。。为什么会这样呢，我特意在初始化中将ADC_InitStructure.ExternalTrigconv=ExternalTrigconv_none.也就是将他赋值为0，然而即使程序已经执行过这条语句，这个成员变量的值仍然是0x08007A47，太奇怪了，可能是固件库的bug，08007A47看起来倒像是flash地址了。
忽然想起有一个ADC_DInit（）和Structure_Init（），这两个函数能将ADC配置为RESET
            ...
          </span>
          <div class="post-more-link text-center">
            <a class="btn" href="/2014/07/18/MCU STM32f207 ADC+DMA多通道采集，ADC数据大于4096/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2014/07/14/MCU PIC16F689 的编译器 和 编译错误处理/" itemprop="url">
                MCU PIC16F689 的编译器 和 编译错误处理
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2014-07-14T16:47:59+08:00" content="2014-07-14">
            2014-07-14
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/MCU/" itemprop="url" rel="index">
                  <span itemprop="name">MCU</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/2014/07/14/MCU PIC16F689 的编译器 和 编译错误处理/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2014/07/14/MCU PIC16F689 的编译器 和 编译错误处理/" itemprop="commentsCount"></span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
            简述公司让改一个PIC16F589的固件，增加一些功能模式的选择等，难的不在于怎么改这些东西，这些东西只要读读程序，理解下原来的构架思路，很容易写出来。难的地方在编译器和开发环境。之前也搞过PIC18F4520的事情，对PIC单片机编译环境的复杂难用深有感触。现在要搞这个PIC16F的单片机，配置环境花了一天时间，主要是一开始给我的源程序就是错误的版本，后来找到问题所在，拿到了正确的源程序，又下载到了2个月试用期的HI tech PICC编译器pro版本，才能够基本上编译。编译器版本是：

MAPLAB IDE v8.86 and  the compiler is :HI-TECH C Compiler for PIC10/12/16 MCUs (PRO Mode)  V9.81
Copyright (C) 2010 Microchip Technology Inc.
Licensed for evaluation purposes only.
This license will expire on Thu, 31 Jul 2014.

可能由于版本原因出现了一些编译错误，记录如下：

            ...
          </span>
          <div class="post-more-link text-center">
            <a class="btn" href="/2014/07/14/MCU PIC16F689 的编译器 和 编译错误处理/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2014/07/09/MCU 函数的递归调用与FATFS中如何scanfile/" itemprop="url">
                MCU 函数的递归调用与FATFS中如何scanfile
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2014-07-09T09:20:16+08:00" content="2014-07-09">
            2014-07-09
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/MCU/" itemprop="url" rel="index">
                  <span itemprop="name">MCU</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/2014/07/09/MCU 函数的递归调用与FATFS中如何scanfile/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2014/07/09/MCU 函数的递归调用与FATFS中如何scanfile/" itemprop="commentsCount"></span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
            一些函数调用的细节问题：调用前
一个函数的运行期间调用另一个函数时，在运行被调用函数之前，系统需要完成3件事情：

将所有的实参、返回地址等信息传递给被调用函数保存；
为被调用函数的局部变量分配存储区；
将控制转移到被调函数的入口。调用中

而从被调用函数返回调用函数之前，系统也应完成3件工作：

保存被调函数的计算结果；
释放被调函数的数据区；
依照被调函数保存的返回地址将控制转移到调用函数。当有多个函数构成嵌套调用时，按照后调用先返回的原则。

也就是说，在调用一个函数之前，都会为被调用函数的局部变量分配存储区。看一下FATFS文件系统中如何做一个能扫两级文件夹的文件扫描。源代码如下：1234567891011121314151617181920212223242526272829303132333435363738394041424344u8 mf_scan_files(char * path,u8 recu_level)&#123;	u8 res;FILINFO fileinfo;		DIR dir;    char *fn;   /* This function is ass
            ...
          </span>
          <div class="post-more-link text-center">
            <a class="btn" href="/2014/07/09/MCU 函数的递归调用与FATFS中如何scanfile/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2014/06/30/MCU STM32f207 USB HOST读U盘终于有点眉目了，写写自己的学习过程和经验/" itemprop="url">
                MCU STM32f207 USB HOST读U盘终于有点眉目了，写写自己的学习过程和经验
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2014-06-30T16:06:02+08:00" content="2014-06-30">
            2014-06-30
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/MCU/" itemprop="url" rel="index">
                  <span itemprop="name">MCU</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/2014/06/30/MCU STM32f207 USB HOST读U盘终于有点眉目了，写写自己的学习过程和经验/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2014/06/30/MCU STM32f207 USB HOST读U盘终于有点眉目了，写写自己的学习过程和经验/" itemprop="commentsCount"></span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
            半个月前开始搞USB HOST读U盘的固件，一开始也是什么都不懂，只是以前搞过cypress的USB芯片CY7C68013A，对USB协议有一点基础。

为了搞好USB，首先阅读了圈圈的《圈圈教你玩USB》 这本书，书写的很详细，跟着他的思路走，能把USB协议的各个部分都接触到，即使硬件条件不同，但他的固件是自己一步一步写出来的，对USB的通信过程理解有很大帮助。

然后就是熟悉stm32的USB 固件库，首先用DEVICE库的例子，自己修改，由于当时只有stm32f103的硬件条件，做了一个使用内部FLASH空间的256K小U盘，这样对USB device的固件结构有了大概了解。

之后，了解FATFS的内容，将FATFS移植到stm32f103上，目的就是管理着256KB的FLASH空间，这样结合USB device的固件，就可以通过电脑修改文件，然后通过串口发送命令，使用FATFS读或者写文件，观察效果。这样就熟悉了FATFS文件系统的使用和移植注意事项。

再下来就是官方的OTG_FS库了，这个库适用于包含OTG模块的f105,107和f2xx系列，这个库有一个说明文档pdf，
            ...
          </span>
          <div class="post-more-link text-center">
            <a class="btn" href="/2014/06/30/MCU STM32f207 USB HOST读U盘终于有点眉目了，写写自己的学习过程和经验/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/">&laquo;</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/">&raquo;</a>
  </nav>

 </div>

        

        
      </div>

      
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      <section class="site-overview">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" src="https://avatars2.githubusercontent.com/u/13464469?v=3&s=460" alt="CaptainJe" itemprop="image"/>
          <p class="site-author-name" itemprop="name">CaptainJe</p>
        </div>
        <p class="site-description motion-element" itemprop="description">Brave Shine</p>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">36</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            <a href="/categories">
              <span class="site-state-item-count">10</span>
              <span class="site-state-item-name">分类</span>
              </a>
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">28</span>
              <span class="site-state-item-name">标签</span>
              </a>
          </div>

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/CaptainJe" target="_blank">Github</a>
              </span>
            
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner"> <div class="copyright" >
  
  &copy; &nbsp;  2013 - 
  <span itemprop="copyrightYear">2015</span>
  <span class="with-love">
    <i class="icon-next-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">CaptainJe</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


 </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  
  
    

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"captainje"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>
    
     

    
  
  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.5.1"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.5.1"></script>
  

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/js/motion_global.js?v=0.4.5.1" id="motion.global"></script>




  <script type="text/javascript" src="/js/nav-toggle.js?v=0.4.5.1"></script>
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  

  <script type="text/javascript">
    $(document).ready(function () {
      if (CONFIG.sidebar === 'always') {
        displaySidebar();
      }
      if (isMobile()) {
        FastClick.attach(document.body);
      }
    });
  </script>

  

  
  

  
  <script type="text/javascript" src="/js/lazyload.js"></script>
  <script type="text/javascript">
    $(function () {
      $("#posts").find('img').lazyload({
        placeholder: "/images/loading.gif",
        effect: "fadeIn"
      });
    });
  </script>
</body>
</html>
